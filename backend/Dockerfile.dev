# Ten plik powinien znaleźć się w folderze: backend/Dockerfile.dev

# Używamy oficjalnego, lekkiego obrazu Javy w wersji 21
FROM openjdk:21-jdk-slim

# Ustawiamy katalog roboczy wewnątrz kontenera
WORKDIR /app

# Kopiujemy pliki definicji Mavena, aby cache'ować zależności.
# To znacznie przyspiesza ponowne budowanie obrazu.
COPY pom.xml .
COPY .mvn/ .mvn
COPY mvnw .

# Pobieramy zależności (ten krok zostanie zcache'owany, jeśli pliki pom nie ulegną zmianie)
# Używamy opcji -B (batch mode), aby uniknąć problemów z logowaniem
RUN ./mvnw dependency:go-offline -B

# Kopiujemy resztę kodu źródłowego
COPY src ./src

# Uruchamiamy aplikację w trybie deweloperskim.
# Spring Boot DevTools zajmie się automatycznym przeładowaniem po wykryciu zmian w kodzie.
CMD ["./mvnw", "spring-boot:run"]
